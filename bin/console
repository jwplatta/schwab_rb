#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"
require "dotenv"
require "schwab_rb"

Dotenv.load

SchwabRb.configure do |config|
  config.log_level = "DEBUG"
end

def client
  @client ||= SchwabRb::Auth.init_client_easy(
    ENV.fetch("SCHWAB_API_KEY", nil),
    ENV.fetch("SCHWAB_APP_SECRET", nil),
    ENV.fetch("SCHWAB_APP_CALLBACK_URL", nil),
    ENV.fetch("SCHWAB_TOKEN_PATH", "schwab_token.json")
  )
end

$client = client

puts "Client initialized."
puts "Access via 'client' method or '$client' global variable."
puts "SchwabRb loaded and ready to use."

ARGV.clear
require "irb"

IRB.start